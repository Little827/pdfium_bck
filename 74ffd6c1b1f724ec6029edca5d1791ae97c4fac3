{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "c5934844_d97d7235",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 7,
      "author": {
        "id": 5045
      },
      "writtenOn": "2021-08-25T23:59:53Z",
      "side": 1,
      "message": "This is ever slightly inconsistent with https://chromium-review.googlesource.com/c/chromium/tools/build/+/3120265",
      "range": {
        "startLine": 7,
        "startChar": 1,
        "endLine": 7,
        "endChar": 6
      },
      "revId": "74ffd6c1b1f724ec6029edca5d1791ae97c4fac3",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "699ef18d_bf2ddff2",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 7,
      "author": {
        "id": 7620
      },
      "writtenOn": "2021-08-26T03:02:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c5934844_d97d7235",
      "range": {
        "startLine": 7,
        "startChar": 1,
        "endLine": 7,
        "endChar": 6
      },
      "revId": "74ffd6c1b1f724ec6029edca5d1791ae97c4fac3",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9f06e35e_4ccf5a4b",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 9,
      "author": {
        "id": 5045
      },
      "writtenOn": "2021-08-25T23:59:53Z",
      "side": 1,
      "message": "This adds a bit more information than what\u0027s already in the subject line, but readers are still left wondering why. Can you expand the CL description slightly to briefly answer that?",
      "revId": "74ffd6c1b1f724ec6029edca5d1791ae97c4fac3",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e1b972ac_9c154b63",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 9,
      "author": {
        "id": 7620
      },
      "writtenOn": "2021-08-26T03:02:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9f06e35e_4ccf5a4b",
      "revId": "74ffd6c1b1f724ec6029edca5d1791ae97c4fac3",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f647c239_cb9bbe28",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 7620
      },
      "writtenOn": "2021-08-25T23:47:50Z",
      "side": 1,
      "message": "https://crrev.com/c/3120265 is the follow-up CL that updates the build flag for actual MSVC bots.",
      "revId": "74ffd6c1b1f724ec6029edca5d1791ae97c4fac3",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f024ca88_8f773743",
        "filename": "BUILD.gn",
        "patchSetId": 3
      },
      "lineNbr": 47,
      "author": {
        "id": 5045
      },
      "writtenOn": "2021-08-25T23:56:44Z",
      "side": 1,
      "message": "You probably want to set /arch:SSE2 instead.",
      "revId": "74ffd6c1b1f724ec6029edca5d1791ae97c4fac3",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b6c8ba4b_2e1be3ec",
        "filename": "BUILD.gn",
        "patchSetId": 3
      },
      "lineNbr": 47,
      "author": {
        "id": 7620
      },
      "writtenOn": "2021-08-26T03:01:17Z",
      "side": 1,
      "message": "/ach:SSE2 is usually used as a cflag.\n\nSo far I tried the following changes:\ncflags +\u003d [ \"/arch:SSE2\" ] or defines +\u003d[ \"/arch:SSE2\" ], either way will result in freetype code not recognizing flag __SSE2__.",
      "parentUuid": "f024ca88_8f773743",
      "revId": "74ffd6c1b1f724ec6029edca5d1791ae97c4fac3",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7fa9cdbe_c9b99325",
        "filename": "BUILD.gn",
        "patchSetId": 3
      },
      "lineNbr": 47,
      "author": {
        "id": 5045
      },
      "writtenOn": "2021-08-26T04:54:40Z",
      "side": 1,
      "message": "Yes, /arch:SSE2 is a cflag, so don\u0027t try to set it in defines.\n\nIf you look at the MSVC documentation, you\u0027ll see MSVC doesn\u0027t set __SSE2__. Instead, it sets _M_IX86_FP to 2.\n\nbungeman/drott: Can we add the following additional check when defining BEZIER_USE_DDA?\n\ndefined(_M_IX86_FP) \u0026\u0026 _M_IX86_FP \u003e\u003d 2\n\nThis is used in libpng and some other libraries.",
      "parentUuid": "b6c8ba4b_2e1be3ec",
      "revId": "74ffd6c1b1f724ec6029edca5d1791ae97c4fac3",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5930a58f_2bdff290",
        "filename": "BUILD.gn",
        "patchSetId": 3
      },
      "lineNbr": 47,
      "author": {
        "id": 7620
      },
      "writtenOn": "2021-08-26T17:52:55Z",
      "side": 1,
      "message": "I tested using \"cflags +\u003d [ \"/arch:SSE2\" ]\" in BUILD.gn, and replacing \"defined(__SSE2__)\" with \"defined(_M_IX86_FP) \u0026\u0026 _M_IX86_FP \u003e\u003d 2\" in freetype\\src\\src\\smooth\\ftgrays.c. This change guaranteed `BEZIER_USE_DDA` to be true but the value of \"defined(__SSE2__)\" will be false.\n\nIf we use \"defines +\u003d [\"__SSE2__\"]\" in BUILD.gn and replace \"defined(__SSE2__)\" with \"defined(_M_IX86_FP) \u0026\u0026 _M_IX86_FP \u003e\u003d 2\" in freetype\\src\\src\\smooth\\ftgrays.c, \n`BEZIER_USE_DDA` and the value of \"defined(__SSE2__)\" will both be true.\n\nBoth ways fit PDFium\u0027s need (`BEZIER_USE_DDA` being true) and I don\u0027t see checks of __SSE2__ outside freetype\\src\\src\\smooth\\ftgrays.c. So the first change is preferable.\n\nNow we will need bungeman@\u0027s / drott@\u0027s approval for the freetype change.",
      "parentUuid": "7fa9cdbe_c9b99325",
      "revId": "74ffd6c1b1f724ec6029edca5d1791ae97c4fac3",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3e3756c6_0e1fbbe7",
        "filename": "BUILD.gn",
        "patchSetId": 3
      },
      "lineNbr": 47,
      "author": {
        "id": 5045
      },
      "writtenOn": "2021-08-26T18:38:15Z",
      "side": 1,
      "message": "Defines that start with double underscores are reserved for the compiler, so PDFium as a program shouldn\u0027t define them. It would be weird, for instance, to define __SSE2__, and then pass /arch:IA32 to MSVC.",
      "parentUuid": "5930a58f_2bdff290",
      "revId": "74ffd6c1b1f724ec6029edca5d1791ae97c4fac3",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0acd6e67_ddc7c582",
        "filename": "BUILD.gn",
        "patchSetId": 3
      },
      "lineNbr": 47,
      "author": {
        "id": 5845
      },
      "writtenOn": "2021-08-26T18:43:43Z",
      "side": 1,
      "message": "So what you would like is for FreeType to check \"( defined(_M_IX86_FP) \u0026\u0026 _M_IX86_FP \u003e\u003d 2 )\" here as well as __SSE2__? That sounds reasonable. Seems this needs to be done in pngshim.c and ftgrays.c, though might be better to have a FT_SSE2_DETECTED macro somewhere central. This is certainly something upstream would be interested in.",
      "parentUuid": "3e3756c6_0e1fbbe7",
      "revId": "74ffd6c1b1f724ec6029edca5d1791ae97c4fac3",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dd820a82_7ef4940e",
        "filename": "BUILD.gn",
        "patchSetId": 3
      },
      "lineNbr": 47,
      "author": {
        "id": 5045
      },
      "writtenOn": "2021-08-26T18:56:10Z",
      "side": 1,
      "message": "Yes, that\u0027s what we are asking for, since MSVC doesn\u0027t set __SSE2__. Adding FT_SSE2_DETECTED to centralize the CPU feature detection is certainly a good idea too. In either case, would you be able to help take this on, given you are already familiar with the FreeType development process?",
      "parentUuid": "0acd6e67_ddc7c582",
      "revId": "74ffd6c1b1f724ec6029edca5d1791ae97c4fac3",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "334e7d97_4455be73",
        "filename": "BUILD.gn",
        "patchSetId": 3
      },
      "lineNbr": 47,
      "author": {
        "id": 5845
      },
      "writtenOn": "2021-08-26T20:22:22Z",
      "side": 1,
      "message": "Created https://gitlab.freedesktop.org/freetype/freetype/-/merge_requests/80",
      "parentUuid": "dd820a82_7ef4940e",
      "revId": "74ffd6c1b1f724ec6029edca5d1791ae97c4fac3",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "06e2a2e2_27030245",
        "filename": "BUILD.gn",
        "patchSetId": 3
      },
      "lineNbr": 47,
      "author": {
        "id": 7620
      },
      "writtenOn": "2021-08-26T20:54:55Z",
      "side": 1,
      "message": "Thanks Ben!",
      "parentUuid": "334e7d97_4455be73",
      "revId": "74ffd6c1b1f724ec6029edca5d1791ae97c4fac3",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2358054d_c39f7060",
        "filename": "BUILD.gn",
        "patchSetId": 3
      },
      "lineNbr": 47,
      "author": {
        "id": 5845
      },
      "writtenOn": "2021-08-27T14:02:19Z",
      "side": 1,
      "message": "So this FreeType pull request has landed upstream and has rolled into Chromium. I think you\u0027ll want to roll FreeType in Pdfium and then the \u0027/arch:SSE2\u0027 here (at Patch set 9) should have the expected effect.",
      "parentUuid": "06e2a2e2_27030245",
      "revId": "74ffd6c1b1f724ec6029edca5d1791ae97c4fac3",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6c296c04_2f257434",
        "filename": "BUILD.gn",
        "patchSetId": 3
      },
      "lineNbr": 47,
      "author": {
        "id": 6715
      },
      "writtenOn": "2021-08-27T14:37:03Z",
      "side": 1,
      "message": "Thanks Ben for addressing that!",
      "parentUuid": "2358054d_c39f7060",
      "revId": "74ffd6c1b1f724ec6029edca5d1791ae97c4fac3",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "30400870_d6e45a48",
        "filename": "BUILD.gn",
        "patchSetId": 3
      },
      "lineNbr": 47,
      "author": {
        "id": 7620
      },
      "writtenOn": "2021-08-27T16:40:29Z",
      "side": 1,
      "message": "Thanks Ben! We need to merge this change first so that the PDFium bots can be updated.\n\nA roll FreeType CL and its matching corpus tests can be merged after this, since we are first blocked on change https://chromium.googlesource.com/chromium/src/third_party/freetype2.git/+/56cc2ad446e920164e823e78a21972cadb339bfc.",
      "parentUuid": "6c296c04_2f257434",
      "revId": "74ffd6c1b1f724ec6029edca5d1791ae97c4fac3",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ad1139a0_62092d39",
        "filename": "pdfium.gni",
        "patchSetId": 3
      },
      "lineNbr": 72,
      "author": {
        "id": 5045
      },
      "writtenOn": "2021-08-26T00:04:40Z",
      "side": 1,
      "message": "Alternatively, set the default to true. SSE2 was introduced in 2000 and Chromium has required it since at least 2010. I hear that Windows 8 and up also require SSE2. In which case, you don\u0027t even need to change the build recipe.",
      "revId": "74ffd6c1b1f724ec6029edca5d1791ae97c4fac3",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "366932ee_20fe04d8",
        "filename": "pdfium.gni",
        "patchSetId": 3
      },
      "lineNbr": 72,
      "author": {
        "id": 5045
      },
      "writtenOn": "2021-08-26T00:10:33Z",
      "side": 1,
      "message": "Actually, not 2010. It was 2014. https://crbug.com/349320",
      "parentUuid": "ad1139a0_62092d39",
      "revId": "74ffd6c1b1f724ec6029edca5d1791ae97c4fac3",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c2a92cfe_9db3ac3f",
        "filename": "pdfium.gni",
        "patchSetId": 3
      },
      "lineNbr": 72,
      "author": {
        "id": 7620
      },
      "writtenOn": "2021-08-26T03:01:17Z",
      "side": 1,
      "message": "Thanks for the update! Done.",
      "parentUuid": "366932ee_20fe04d8",
      "revId": "74ffd6c1b1f724ec6029edca5d1791ae97c4fac3",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7d2591d7_b8d3dd81",
        "filename": "pdfium.gni",
        "patchSetId": 3
      },
      "lineNbr": 72,
      "author": {
        "id": 5045
      },
      "writtenOn": "2021-08-28T00:30:01Z",
      "side": 1,
      "message": "Since this CL ended up setting msvc_use_sse2 \u003d true by default, we should let the public PDFium group know, so nobody gets surprised by this change.\n\nThe msvc_use_sse2 setting also may not work if someone is trying to build with MSVC for Windows ARM. We can either fix that blindly as another follow-up, or wait to someone to complain, and work with them to verify the fix.",
      "parentUuid": "c2a92cfe_9db3ac3f",
      "revId": "74ffd6c1b1f724ec6029edca5d1791ae97c4fac3",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dfa2285d_99a1d070",
        "filename": "samples/pdfium_test.cc",
        "patchSetId": 3
      },
      "lineNbr": 22,
      "author": {
        "id": 5045
      },
      "writtenOn": "2021-08-25T23:56:44Z",
      "side": 1,
      "message": "If BUILD.gn alrady defined __SSE2__, why does this file need to do it again?",
      "revId": "74ffd6c1b1f724ec6029edca5d1791ae97c4fac3",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2520b8ed_4fcb6b5c",
        "filename": "samples/pdfium_test.cc",
        "patchSetId": 3
      },
      "lineNbr": 22,
      "author": {
        "id": 7620
      },
      "writtenOn": "2021-08-26T03:01:17Z",
      "side": 1,
      "message": "Updating BUILD.gn will affect the \"__SSE2__\" flag in third_party/freetype. However, it doesn\u0027t affect the \"__SSE2__\" flag inside sample/pdfium_test.cc.\n\n(1) If __SSE2__ is only going to be used in other third-party libraries, we could remove the changes in samples/BUILD.gn files and samples/pdfium_test.cc.\n\n(2) If we ever going to directly use __SSE2__ in PDFium, we\u0027ll need to update samples/BUILD.gn files and samples/pdfium_test.cc so that the flag \"__SSE2__\" value is consistent with what\u0027s used in third-party code. (It\u0027s done in a similar way for _SKIA_SUPPORT_PATHS_ flag as well.)\n\nI think right now we are in case (1). I will remove the changes in //samples/.",
      "parentUuid": "dfa2285d_99a1d070",
      "revId": "74ffd6c1b1f724ec6029edca5d1791ae97c4fac3",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    }
  ]
}