{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "887fe3ad_93d0ca5e",
        "filename": "fpdfsdk/fpdf_structtree.cpp",
        "patchSetId": 8
      },
      "lineNbr": 174,
      "author": {
        "id": 5045
      },
      "writtenOn": "2022-02-12T01:11:41Z",
      "side": 1,
      "message": "BTW, all the APIs that use WideStringToBuffer() have a small bug. On failure, these APIs return 0. On success with an empty string, they also return 0. This is ambiguous, and it would be best to not have APIs with ambiguous return values.\n\nIf the caller looks past the API boundary, they can of course see that if they passed in a non-null FPDF_STRUCTELEMENT, the API will succeed. But the caller shouldn\u0027t have to rely on this knowledge.\n\nAll the APIs outside of this file uses Utf16EncodeMaybeCopyAndReturnLength(), which solves the ambiguity by returning 2 for empty string and 0 for failure. The APIs that use that helper function writes a double NUL (\"\\0\\0\") into the buffer for empty strings.\n\nTo fix this for the existing, non-experimental API, they\u0027ll need replacement APIs and an API deprecation cycle that will run for some time. For FPDF_StructElement_GetObjType(), if you want to switch to Utf16EncodeMaybeCopyAndReturnLength() now, that would be great. Or leave it as is, but it\u0027ll just change at some point in the future, as this is an experimental API with no API guarantees.",
      "range": {
        "startLine": 174,
        "startChar": 16,
        "endLine": 174,
        "endChar": 35
      },
      "revId": "f659313f1d9fb06722c2c8e8b7f16da08b144b7c",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "eb344023_fbefe5ad",
        "filename": "fpdfsdk/fpdf_structtree.cpp",
        "patchSetId": 8
      },
      "lineNbr": 174,
      "author": {
        "id": 5045
      },
      "writtenOn": "2022-02-12T01:14:37Z",
      "side": 1,
      "message": "This is crbug.com/pdfium/1566. I have way too many bugs on my plate and forgot it existed.",
      "parentUuid": "887fe3ad_93d0ca5e",
      "range": {
        "startLine": 174,
        "startChar": 16,
        "endLine": 174,
        "endChar": 35
      },
      "revId": "f659313f1d9fb06722c2c8e8b7f16da08b144b7c",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7ed369af_5ebbf880",
        "filename": "fpdfsdk/fpdf_structtree.cpp",
        "patchSetId": 8
      },
      "lineNbr": 174,
      "author": {
        "id": 8786
      },
      "writtenOn": "2022-02-12T01:22:57Z",
      "side": 1,
      "message": "I would defer it for mass cleanup.",
      "parentUuid": "eb344023_fbefe5ad",
      "range": {
        "startLine": 174,
        "startChar": 16,
        "endLine": 174,
        "endChar": 35
      },
      "revId": "f659313f1d9fb06722c2c8e8b7f16da08b144b7c",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a04328a0_24a38b0e",
        "filename": "fpdfsdk/fpdf_structtree.cpp",
        "patchSetId": 8
      },
      "lineNbr": 174,
      "author": {
        "id": 8786
      },
      "writtenOn": "2022-02-12T01:23:12Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "7ed369af_5ebbf880",
      "range": {
        "startLine": 174,
        "startChar": 16,
        "endLine": 174,
        "endChar": 35
      },
      "revId": "f659313f1d9fb06722c2c8e8b7f16da08b144b7c",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3c06d247_5fb89f06",
        "filename": "fpdfsdk/fpdf_structtree.cpp",
        "patchSetId": 8
      },
      "lineNbr": 174,
      "author": {
        "id": 5045
      },
      "writtenOn": "2022-02-12T01:26:24Z",
      "side": 1,
      "message": "Sure. FPDF_StructElement_GetActualText() is also affected, FYI.",
      "parentUuid": "a04328a0_24a38b0e",
      "range": {
        "startLine": 174,
        "startChar": 16,
        "endLine": 174,
        "endChar": 35
      },
      "revId": "f659313f1d9fb06722c2c8e8b7f16da08b144b7c",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    }
  ]
}