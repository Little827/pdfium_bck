{
  "comments": [
    {
      "key": {
        "uuid": "3a81569e_b7d75fc5",
        "filename": "core/fpdfapi/parser/cpdf_cross_ref_table.cpp",
        "patchSetId": 5
      },
      "lineNbr": 115,
      "author": {
        "id": 5045
      },
      "writtenOn": "2018-07-25T18:14:20Z",
      "side": 1,
      "message": "Before this CL, CPDF_Parser::GetLastObjNum() only relies on |objects_info_| to calculate its result. So it is easy to see ShrinkObjectMap() does sufficient bookkeeping with its |objects_info_| updates. e.g. ShrinkObjectMap(5) will always result in GetLastObjNum() returning 4.\n\nNow, CPDF_Parser::GetLastObjNum() relies on CPDF_CrossRefTable::GetSize(), which uses both |objects_info_| and the Size value from the trailer. Yet, ShrinkObjectMap() does not update the trailer. So now there is potential for ShrinkObjectMap() to not have the desired effect. e.g. after calling ShrinkObjectMap(5), GetLastObjNum() can potentially return 5 or higher.\n\nIt would be better if ShrinkObjectMap() had more encapsulation. I have an idea to improve this. I\u0027ll try to make a CL for that soon.",
      "revId": "272b6629328a6de8c698ef0ea6a1b233ccc6c06f",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b",
      "unresolved": true
    }
  ]
}