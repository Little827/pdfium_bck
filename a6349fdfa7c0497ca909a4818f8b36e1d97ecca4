{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "63f1bbc0_bd5c16e3",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 7,
      "author": {
        "id": 5495
      },
      "writtenOn": "2021-06-08T16:00:42Z",
      "side": 1,
      "message": "nit: maybe say:\n\nUse double values for PixelWeight::m_Weights[].\n\nThis fixes uneven background for some images.",
      "range": {
        "startLine": 7,
        "startChar": 4,
        "endLine": 7,
        "endChar": 10
      },
      "revId": "a6349fdfa7c0497ca909a4818f8b36e1d97ecca4",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9ed37e7e_d4c47738",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 7,
      "author": {
        "id": 5495
      },
      "writtenOn": "2021-06-08T16:00:42Z",
      "side": 1,
      "message": "Nit: 72 cols for commit messages, 80 cols otherwise.",
      "range": {
        "startLine": 7,
        "startChar": 0,
        "endLine": 7,
        "endChar": 3
      },
      "revId": "a6349fdfa7c0497ca909a4818f8b36e1d97ecca4",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6fcfc88e_e63873bf",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 7,
      "author": {
        "id": 5045
      },
      "writtenOn": "2021-06-08T16:09:44Z",
      "side": 1,
      "message": "It\u0027ll be great if you can file a bug on crbug.com/pdfium to describe what the issue is, maybe with an example.",
      "parentUuid": "63f1bbc0_bd5c16e3",
      "range": {
        "startLine": 7,
        "startChar": 4,
        "endLine": 7,
        "endChar": 10
      },
      "revId": "a6349fdfa7c0497ca909a4818f8b36e1d97ecca4",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "da2cbee8_7ee7f9b0",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 7,
      "author": {
        "id": 8606
      },
      "writtenOn": "2021-06-08T16:35:13Z",
      "side": 1,
      "message": "done - https://bugs.chromium.org/p/pdfium/issues/detail?id\u003d1688",
      "parentUuid": "6fcfc88e_e63873bf",
      "range": {
        "startLine": 7,
        "startChar": 4,
        "endLine": 7,
        "endChar": 10
      },
      "revId": "a6349fdfa7c0497ca909a4818f8b36e1d97ecca4",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b8293d2b_68a0aede",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 5495
      },
      "writtenOn": "2021-06-08T15:00:46Z",
      "side": 1,
      "message": "Hi, thanks immensely for the patch!\n\nI\u0027ve often wondered if there are places where we\u0027d be better off using doubles - due to the age of the code, there are mainly float calculations on the belief that it is important to be more efficient.\n\nI\u0027m going to kick off the \"try jobs\" to see if this changes any of our tests. If not, we might ask if you have a small self-contained .pdf that we could add to show the effect of this change.\n\nThere are a number of style points that we\u0027re going to ask you to change before accepting the patch. These are minor; after fixing them please re-upload another version of the patch.\n",
      "revId": "a6349fdfa7c0497ca909a4818f8b36e1d97ecca4",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9c363a41_01448ff4",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 5495
      },
      "writtenOn": "2021-06-08T16:00:42Z",
      "side": 1,
      "message": "Ah, I see we\u0027re changing an int to a double -- somehow I misunderstood and thought we were changing a float to a double. Which means that that cost may matter. @thestig - any feel for the cost of this patch?",
      "revId": "a6349fdfa7c0497ca909a4818f8b36e1d97ecca4",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d8f4fe4f_4cecd1ff",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 5045
      },
      "writtenOn": "2021-06-08T16:09:44Z",
      "side": 1,
      "message": "I can certainly help with benchmarking this.",
      "parentUuid": "9c363a41_01448ff4",
      "revId": "a6349fdfa7c0497ca909a4818f8b36e1d97ecca4",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "cc29627d_8e1b8d87",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 8606
      },
      "writtenOn": "2021-06-08T16:35:13Z",
      "side": 1,
      "message": "done - https://bugs.chromium.org/p/pdfium/issues/detail?id\u003d1688",
      "revId": "a6349fdfa7c0497ca909a4818f8b36e1d97ecca4",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "50892388_1520236e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 5045
      },
      "writtenOn": "2021-06-08T17:48:41Z",
      "side": 1,
      "message": "In my private set of PDFs used for benchmarking, rendering takes 39% longer overall.\n\n50th percentile: 3% longer\n75th percentile: 45%\n90th percentile: 127%",
      "parentUuid": "d8f4fe4f_4cecd1ff",
      "revId": "a6349fdfa7c0497ca909a4818f8b36e1d97ecca4",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "471ade62_8e5cda62",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 5495
      },
      "writtenOn": "2021-06-08T18:34:48Z",
      "side": 1,
      "message": "Wow.  That might argue for \"fixed-point\" arithmetic, eg. store (16 * double value) as an int, then \u003e\u003e 4 after an int multiply -- if the range will allwow.",
      "parentUuid": "50892388_1520236e",
      "revId": "a6349fdfa7c0497ca909a4818f8b36e1d97ecca4",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "440aab91_4e1587ad",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 8606
      },
      "writtenOn": "2021-06-08T18:39:17Z",
      "side": 1,
      "message": "at first I tried to do this, the artifacts in the form of a grid remain (the multiplier was 64)",
      "revId": "a6349fdfa7c0497ca909a4818f8b36e1d97ecca4",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e9bfeff5_26a68d43",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 8606
      },
      "writtenOn": "2021-06-08T18:42:11Z",
      "side": 1,
      "message": "I understand that this is quite slow, but we are satisfied with the quality at the expense of performance.\nLet me know if you need this fix",
      "revId": "a6349fdfa7c0497ca909a4818f8b36e1d97ecca4",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d33dbed4_405356d1",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 5495
      },
      "writtenOn": "2021-06-08T19:23:07Z",
      "side": 1,
      "message": "Ok, I\u0027m not 100% of the range of these values, but it looks like we are multiplying by 65536 at a few places. So I\u0027m guessing that these are in the 0..65535 and you might be able to get away with more fractional bits - what happens at, say 12 bits (4096x) while leaves a few extra for overflow, etc?",
      "parentUuid": "440aab91_4e1587ad",
      "revId": "a6349fdfa7c0497ca909a4818f8b36e1d97ecca4",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c8d32da1_4ad91e3b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 8606
      },
      "writtenOn": "2021-06-08T19:50:14Z",
      "side": 1,
      "message": "Ok, I\u0027ll try, I think it should work",
      "revId": "a6349fdfa7c0497ca909a4818f8b36e1d97ecca4",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6bbd71a7_662c35a6",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 5495
      },
      "writtenOn": "2021-06-08T20:26:58Z",
      "side": 1,
      "message": "It also looks like this same PixelWeight struct is used in progressive_decoder.cpp, possibly with hidden dependencies on its layout. If I can unify these first, it will make landing your patch easier.",
      "revId": "a6349fdfa7c0497ca909a4818f8b36e1d97ecca4",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a4c29452_bfedb216",
        "filename": "core/fxge/dib/cstretchengine.cpp",
        "patchSetId": 1
      },
      "lineNbr": 33,
      "author": {
        "id": 5495
      },
      "writtenOn": "2021-06-08T16:00:42Z",
      "side": 1,
      "message": "We can make this correct no matter how the struct may change in the future if we write:\n\n  size_t extra_bytes \u003d m_ItemSize - sizeof(PixelWeight);\n  return 1 + extra_bytes / sizeof(PixelWeight::m_Wieights[0])",
      "range": {
        "startLine": 33,
        "startChar": 9,
        "endLine": 33,
        "endChar": 57
      },
      "revId": "a6349fdfa7c0497ca909a4818f8b36e1d97ecca4",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "40523d60_69936e30",
        "filename": "core/fxge/dib/cstretchengine.cpp",
        "patchSetId": 1
      },
      "lineNbr": 53,
      "author": {
        "id": 5495
      },
      "writtenOn": "2021-06-08T16:00:42Z",
      "side": 1,
      "message": "Nit: I don\u0027t think the static cast to float was ever require as fabs() expects a double argument.\n\nWhile we\u0027re here, we can make this correct no matter how the PixelWeight struct changes in the futures and easier on future readers by writing this like:\n\n const size_t weights_per_item \u003d  static_cast\u003csize_t\u003e(ceil(fabs(scale))) + 1;\n m_ItemSize \u003d sizeof(PixelWeight) + (weights_per_item - 1) * sizeof(PixelWeight.m_Weights[0]);\n \nIn fact I\u0027m going to put together a standalone patch to get this change in first so that this CL will only have to change to double and round.",
      "range": {
        "startLine": 50,
        "startChar": 2,
        "endLine": 53,
        "endChar": 0
      },
      "revId": "a6349fdfa7c0497ca909a4818f8b36e1d97ecca4",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "01104027_5afd6e63",
        "filename": "core/fxge/dib/cstretchengine.cpp",
        "patchSetId": 1
      },
      "lineNbr": 74,
      "author": {
        "id": 5495
      },
      "writtenOn": "2021-06-08T16:00:42Z",
      "side": 1,
      "message": "nit: 80 columns.\n\nThe `git cl format` command will fix these for you.  Please run this in your checkout before uploading patches.",
      "range": {
        "startLine": 74,
        "startChar": 0,
        "endLine": 74,
        "endChar": 10
      },
      "revId": "a6349fdfa7c0497ca909a4818f8b36e1d97ecca4",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5813be65_dfe05a03",
        "filename": "core/fxge/dib/fx_dib.h",
        "patchSetId": 1
      },
      "lineNbr": 35,
      "author": {
        "id": 5495
      },
      "writtenOn": "2021-06-08T16:00:42Z",
      "side": 1,
      "message": "nit: as long as we\u0027re changing this, could you please add a comment\n\ndouble m_Weights[1];  // Not really 1, variable size.\n\n(again, I\u0027ll probably do this in a standalone patch first).",
      "revId": "a6349fdfa7c0497ca909a4818f8b36e1d97ecca4",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    }
  ]
}