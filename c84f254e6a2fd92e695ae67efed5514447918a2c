{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "3388f5a2_6b31127a",
        "filename": "core/fpdfapi/page/cpdf_dib.cpp",
        "patchSetId": 3
      },
      "lineNbr": 144,
      "author": {
        "id": 5045
      },
      "writtenOn": "2023-02-24T00:08:30Z",
      "side": 1,
      "message": "Would it make sense to map 1 to `kDoNothing`, and fail for all other values?",
      "revId": "c84f254e6a2fd92e695ae67efed5514447918a2c",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "54f3b68c_73b57b82",
        "filename": "core/fpdfapi/page/cpdf_dib.cpp",
        "patchSetId": 3
      },
      "lineNbr": 144,
      "author": {
        "id": 5045
      },
      "writtenOn": "2023-02-24T00:08:53Z",
      "side": 1,
      "message": "e.g. What if the components count is 5 or 99?",
      "parentUuid": "3388f5a2_6b31127a",
      "revId": "c84f254e6a2fd92e695ae67efed5514447918a2c",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8dd3b6da_0af2a76c",
        "filename": "core/fpdfapi/page/cpdf_dib.cpp",
        "patchSetId": 3
      },
      "lineNbr": 144,
      "author": {
        "id": 7620
      },
      "writtenOn": "2023-02-24T23:11:51Z",
      "side": 1,
      "message": "If there is not colorspaces specified in the PDF, PDF should just support baseline color spaces + CMYK.\n\nI tested component number of 2,5 and 257 with the PDFs in https://bugs.chromium.org/p/pdfium/issues/detail?id\u003d1747#c7 without specifying color spaces in the PDFs, and Acrobat reported errors and didn\u0027t render those images.",
      "parentUuid": "54f3b68c_73b57b82",
      "revId": "c84f254e6a2fd92e695ae67efed5514447918a2c",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "aef455ad_4e3cdff8",
        "filename": "core/fpdfapi/page/cpdf_dib.cpp",
        "patchSetId": 3
      },
      "lineNbr": 144,
      "author": {
        "id": 7613
      },
      "writtenOn": "2023-02-28T18:45:55Z",
      "side": 1,
      "message": "I\u0027d feel more comfortable with this change if we actually looked at the JPEG 2000 spec and determined what the baseline color spaces are. That requires buying a copy of the JPEG 2000 spec, though.",
      "parentUuid": "8dd3b6da_0af2a76c",
      "revId": "c84f254e6a2fd92e695ae67efed5514447918a2c",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d6ce8732_6efbe73c",
        "filename": "core/fpdfapi/page/cpdf_dib.cpp",
        "patchSetId": 3
      },
      "lineNbr": 144,
      "author": {
        "id": 7613
      },
      "writtenOn": "2023-02-28T21:10:39Z",
      "side": 1,
      "message": "I think a potential way forward here would be to add a function along the lines of, \"has baseline color space,\" then change the definition if we ever get a bug report about it.",
      "parentUuid": "aef455ad_4e3cdff8",
      "revId": "c84f254e6a2fd92e695ae67efed5514447918a2c",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4a3de1c9_2dadddd0",
        "filename": "core/fpdfapi/page/cpdf_dib.cpp",
        "patchSetId": 3
      },
      "lineNbr": 144,
      "author": {
        "id": 5045
      },
      "writtenOn": "2023-03-01T02:46:47Z",
      "side": 1,
      "message": "Keep in mind PDFium is not dealing with JPEG 2000 images directly. Instead, it\u0027s dealing with OpenJPEG.\n\nhttps://citeseerx.ist.psu.edu/document?repid\u003drep1\u0026type\u003dpdf\u0026doi\u003dcefcdfe7e3a12195b9488574355185da6bc99635 has a diagram showing the different color spaces, and the PDF spec talks about some of them as \"enumerated colour space NN\". The code here does not deal with that directly, whereas OpenJPEG does via struct opj_jp2\u0027s enumcs member. Looking at OpenJPEG code, it supports many, but not all the color spaces list in that doc. So the level of support in PDFium will be limited by that.",
      "parentUuid": "d6ce8732_6efbe73c",
      "revId": "c84f254e6a2fd92e695ae67efed5514447918a2c",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9e3f9476_40faf4fd",
        "filename": "core/fpdfapi/page/cpdf_dib.cpp",
        "patchSetId": 3
      },
      "lineNbr": 144,
      "author": {
        "id": 7620
      },
      "writtenOn": "2023-03-01T06:48:18Z",
      "side": 1,
      "message": "From the diagram on page 11, the following color levels are in the blue circle:\ne-sRGB, sRGB, grey-sRGB, sRGB-YCC, Erimm-RGB.\nThese are 3-channel color levels (each channel might contain different number of bits, eg Erimm-RGB.).",
      "parentUuid": "4a3de1c9_2dadddd0",
      "revId": "c84f254e6a2fd92e695ae67efed5514447918a2c",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "18931590_96b3e600",
        "filename": "core/fpdfapi/page/cpdf_dib.cpp",
        "patchSetId": 3
      },
      "lineNbr": 144,
      "author": {
        "id": 7613
      },
      "writtenOn": "2023-03-01T18:06:43Z",
      "side": 1,
      "message": "The PDF spec requires JPX baseline + CMYK (- CIEJab?); perhaps we can assume baseline is the blue circle, although the diagram says JP2, not JPX. Is grey-sRGB a single component space?",
      "parentUuid": "9e3f9476_40faf4fd",
      "revId": "c84f254e6a2fd92e695ae67efed5514447918a2c",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cf9c1423_6ddc445a",
        "filename": "core/fpdfapi/page/cpdf_dib.cpp",
        "patchSetId": 3
      },
      "lineNbr": 144,
      "author": {
        "id": 7620
      },
      "writtenOn": "2023-03-07T00:34:57Z",
      "side": 1,
      "message": "I assume the baseline for JPEG2000 is the blue circle. \n\nLei mentioned that JPX is an extension of the original JPEG2000 (JP2), and the adobe documentation clearly states that \"Consumer applications must support the\nJPX baseline set of enumerated color spaces\". So here are some more detailed findings:\n\nThe baseline colors for JPEG2000 are different types of sRGB and gray scale. (color channel are either 1 or 3, including sRGB-YCC, which has 3 channels)\n\nFor baseline of JPX, I found some answers online (not reliable) that says the baseline colorspaces are sRGB, Adobe RGB(1998), ProPhotoRGB.\n\nI assume we should move forward with the colors all types of RGBs + CYMK.\n\nhttps://www.prepressure.com/pdf/basics/color has the entire list of color spaces to be supported in PDF. \"DeviceN\" is what we are looking at. When \"DeviceN\" is customized number but the color space is not included in the PDF or mentioned in JPEG2000 documentation (JP2+JPX), I think we should fall back on DeviceGray, DeviceRGB and DeviceCMYK as the PDF ref book stated \"If no supported color space is found, the color space used should be DeviceGray, DeviceRGB, or DeviceCMYK, depending on the number of color channels in the JPEG2000 data\".",
      "parentUuid": "18931590_96b3e600",
      "revId": "c84f254e6a2fd92e695ae67efed5514447918a2c",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e3f880e5_512e8fd3",
        "filename": "core/fpdfapi/page/cpdf_dib.cpp",
        "patchSetId": 3
      },
      "lineNbr": 144,
      "author": {
        "id": 7613
      },
      "writtenOn": "2023-03-07T00:41:07Z",
      "side": 1,
      "message": "I\u0027m OK with this course of action. Note, however, that the PDF spec guidance to use DeviceGray, DeviceRGB, or DeviceCMYK only applies when the reader doesn\u0027t support the color space specified in the JPEG 2000 file. That said, we can assume for now that we don\u0027t support other color spaces, like CIELab or ICC profiles. We may need to revisit this in the future to fix color rendering.",
      "parentUuid": "cf9c1423_6ddc445a",
      "revId": "c84f254e6a2fd92e695ae67efed5514447918a2c",
      "serverId": "fca2d64a-0420-3532-b200-12848c95a47b"
    }
  ]
}